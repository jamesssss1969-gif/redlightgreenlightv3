<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Red Light Green Light</title>
  <style>
    body { font-family: system-ui, sans-serif; background:#0f172a; color:#e5e7eb; display:flex; justify-content:center; padding:20px; }
    .panel { background:#020617; padding:20px; border-radius:14px; width:380px; max-width:95vw; box-shadow:0 20px 40px rgba(0,0,0,.6); }
    h1 { text-align:center; margin-top:0; }
    .section { margin-bottom:16px; }
    label { font-size:.85rem; color:#cbd5f5; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    .lights { display:flex; justify-content:space-around; margin:18px 0 10px; }
    .light { width:80px; height:80px; border-radius:50%; background:#1f2937; opacity:.25; transition:.3s; }
    .light.red.active { background:#ef4444; opacity:1; box-shadow:0 0 25px rgba(239,68,68,.8); }
    .light.green.active { background:#22c55e; opacity:1; box-shadow:0 0 25px rgba(34,197,94,.8); }
    .light.amber.active { background:#f59e0b; opacity:1; box-shadow:0 0 25px rgba(245,158,11,.9); }
    #message { text-align:center; min-height:48px; font-size:1.1rem; font-weight:600; margin-bottom:10px; }
    .stopwatch { text-align:center; font-size:.9rem; color:#9ca3af; }
    button { width:100%; padding:12px; border-radius:999px; border:none; background:#1d4ed8; color:#fff; font-size:1rem; font-weight:600; cursor:pointer; margin-top:10px; }
    button.secondary { background:#374151; }
    button:disabled { opacity:.5; cursor:not-allowed; }
    /* Judgment overlay */
    .overlay { position:fixed; inset:0; background:rgba(2,6,23,.92); display:none; align-items:center; justify-content:center; z-index:10; }
    .overlay .card { background:#020617; border-radius:14px; padding:20px; width:320px; box-shadow:0 20px 40px rgba(0,0,0,.6); text-align:center; }
    .overlay .q { font-size:1.05rem; margin-bottom:14px; }
    .overlay .btns { display:flex; gap:10px; }
  </style>
</head>
<body>
<div class="panel">
  <h1>Red Light Green Light</h1>

  <div class="section">
    <label>Red durations (s)</label>
    <div class="row">
      <label><input type="checkbox" class="redDur" value="5" checked>5</label>
      <label><input type="checkbox" class="redDur" value="10" checked>10</label>
      <label><input type="checkbox" class="redDur" value="15">15</label>
      <label><input type="checkbox" class="redDur" value="20">20</label>
      <label><input type="checkbox" class="redDur" value="25">25</label>
      <label><input type="checkbox" class="redDur" value="30">30</label>
    </div>
  </div>

  <div class="section">
    <label>Green durations (s)</label>
    <div class="row">
      <label><input type="checkbox" class="greenDur" value="5">5</label>
      <label><input type="checkbox" class="greenDur" value="10" checked>10</label>
      <label><input type="checkbox" class="greenDur" value="15" checked>15</label>
      <label><input type="checkbox" class="greenDur" value="20">20</label>
      <label><input type="checkbox" class="greenDur" value="25">25</label>
      <label><input type="checkbox" class="greenDur" value="30">30</label>
    </div>
  </div>

  <div class="section">
    <label><input type="checkbox" id="punishToggle" checked> Enable punishments</label>
  </div>

  <div class="section">
    <label><input type="checkbox" id="judgementToggle" checked> Enable Judgement Questions</label>
  </div>

  <div class="section">
    <label>Personality</label>
    <div class="row">
      <label><input type="radio" name="persona" value="authority" checked> Authority</label>
      <label><input type="radio" name="persona" value="encouraging"> Encouraging</label>
    </div>
  </div>

  <div class="lights">
    <div id="red" class="light red"></div>
    <div id="amber" class="light amber"></div>
    <div id="green" class="light green"></div>
  </div>

  <div id="message"></div>
  <div class="stopwatch" id="stopwatch">00:00</div>

  <button id="startBtn">Start</button>
  <button id="readyBtn" class="secondary" disabled>Ready Mode</button>
  <button id="resetBtn" class="secondary">Reset</button>
</div>

<!-- Judgment Overlay -->
<div id="overlay" class="overlay">
  <div class="card">
    <div id="question" class="q">Question</div>
    <div class="btns">
      <button id="yesBtn">Yes</button>
      <button id="noBtn" class="secondary">No</button>
    </div>
  </div>
</div>

<script>
let phase = null, timer = null, timeLeft = 0, stopwatchTimer = null, secondsElapsed = 0, rtcActive = false, judgementArmed = false;

const authorityRed = ['Hold position','Maintain control','Follow the rules','Discipline required','Stay still'];
const encouragingRed = ['Pause here','Take a breath','Not yet','Easy now','Wait'];
const greenTexts = ['Go','Continue','Keep moving','Steady pace','Proceed'];
const punishments = ['Spread your cheeks','Expose your balls','Hump the air','Present for inspection','Hips in the air'];
const judgementQuestions = [
  { q:'Have you followed the rules?', yesPunish:0.2, noPunish:0.8 },
  { q:'Have you been perving?', yesPunish:0.7, noPunish:0.3 },
  { q:'Do you like a finger in the arse?', yesPunish:0.6, noPunish:0.4 },
  { q:'Do you like to expose youself?', yesPunish:0.7, noPunish:0.3 },
  { q:'Do you like being watched?', yesPunish:0.6, noPunish:0.4 }
];

function beep(type){ const ctx=new (window.AudioContext||window.webkitAudioContext)(); const o=ctx.createOscillator(); const g=ctx.createGain(); o.connect(g).connect(ctx.destination); o.type='sine'; o.frequency.value= type==='green'?700:type==='amber'?520:360; g.gain.setValueAtTime(.25,ctx.currentTime); o.start(); o.stop(ctx.currentTime+.25); }
function pickChecked(cls){ const v=[...document.querySelectorAll(`.${cls}:checked`)].map(c=>+c.value); return v.length? v[Math.floor(Math.random()*v.length)]:5; }
function clearLights(){ ['red','green','amber'].forEach(id=>document.getElementById(id).classList.remove('active')); }
function persona(){ return document.querySelector('input[name="persona"]:checked').value; }
function redMessage(){ return persona()==='authority'? authorityRed[Math.floor(Math.random()*authorityRed.length)] : encouragingRed[Math.floor(Math.random()*encouragingRed.length)]; }

function setPhase(p,d){ phase=p; clearLights(); document.getElementById(p).classList.add('active'); beep(p); if(p==='red') message.textContent=redMessage(); if(p==='green') message.textContent=greenTexts[Math.floor(Math.random()*greenTexts.length)]; if(p==='amber') message.textContent=punishments[Math.floor(Math.random()*punishments.length)]; timeLeft=d; }

function maybeJudgement(){ if(judgementToggle.checked && judgementArmed && Math.random()<0.25){ triggerJudgement(); return true; } return false; }

function nextPhase(){ if(maybeJudgement()) return; if(phase==='red'){ if(punishToggle.checked && Math.random()<0.1){ setPhase('amber',10); return; } setPhase('green',pickChecked('greenDur')); } else if(phase==='green'){ setPhase('red',pickChecked('redDur')); } else if(phase==='amber'){ setPhase('green',pickChecked('greenDur')); } }

function tick(){ timeLeft--; if(timeLeft<=0) nextPhase(); }

function startStopwatch(){ stopwatchTimer=setInterval(()=>{ secondsElapsed++; const m=String(Math.floor(secondsElapsed/60)).padStart(2,'0'); const s=String(secondsElapsed%60).padStart(2,'0'); stopwatch.textContent=`${m}:${s}`; if(secondsElapsed>120) judgementArmed=true; },1000); }

function triggerJudgement(){ clearInterval(timer); clearLights(); overlay.style.display='flex'; const item=judgementQuestions[Math.floor(Math.random()*judgementQuestions.length)]; overlay.dataset.yes=item.yesPunish; overlay.dataset.no=item.noPunish; question.textContent=item.q; }
function resolveJudgement(answer){ overlay.style.display='none'; const chance = answer==='yes'? +overlay.dataset.yes : +overlay.dataset.no; if(Math.random()<chance){ setPhase('amber',10); } else { setPhase('red',pickChecked('redDur')); } timer=setInterval(tick,1000); }

let rtcTimer=null, rtcElapsed=0;
function readyMode(){ if(rtcActive) return; rtcActive=true; clearInterval(timer); judgementArmed=false; rtcElapsed=0; setPhase('red',5); rtcTimer=setInterval(()=>{ rtcElapsed+=5; if(phase==='red'){ setPhase('green',15); } else { setPhase('red',5); } if(rtcElapsed>=60){ clearInterval(rtcTimer); clearLights(); message.textContent='Verdict incoming...'; setTimeout(()=>{ if(Math.random()<0.5){ message.textContent='Cum now'; clearLights(); document.getElementById('green').classList.add('active'); beep('green'); } else { message.textContent='Denied'; beep('amber'); rtcActive=false; readyMode(); } },2500); } },5000); }

startBtn.onclick=()=>{ if(timer) return; setPhase('red',pickChecked('redDur')); timer=setInterval(tick,1000); startStopwatch(); readyBtn.disabled=false; };
resetBtn.onclick=()=>{ clearInterval(timer); clearInterval(stopwatchTimer); clearInterval(rtcTimer); timer=null; stopwatchTimer=null; rtcTimer=null; secondsElapsed=0; rtcActive=false; judgementArmed=false; clearLights(); message.textContent=''; stopwatch.textContent='00:00'; readyBtn.disabled=true; };
readyBtn.onclick=readyMode;
yesBtn.onclick=()=>resolveJudgement('yes');
noBtn.onclick=()=>resolveJudgement('no');
</script>
</body>
</html>

