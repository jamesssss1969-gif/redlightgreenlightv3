<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Red Light Green Light</title>
  <style>
    body { font-family: system-ui, sans-serif; background:#0f172a; color:#e5e7eb; display:flex; justify-content:center; padding:20px; }
    .panel { background:#020617; padding:20px; border-radius:14px; width:380px; max-width:95vw; box-shadow:0 20px 40px rgba(0,0,0,.6); }
    h1 { text-align:center; margin-top:0; }
    .section { margin-bottom:16px; }
    label { font-size:.85rem; color:#cbd5f5; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    .lights { display:flex; justify-content:space-around; margin:18px 0 10px; }
    .light { width:80px; height:80px; border-radius:50%; background:#1f2937; opacity:.25; transition:.3s; }
    .light.red.active { background:#ef4444; opacity:1; box-shadow:0 0 25px rgba(239,68,68,.8); }
    .light.green.active { background:#22c55e; opacity:1; box-shadow:0 0 25px rgba(34,197,94,.8); }
    .light.amber.active { background:#f59e0b; opacity:1; box-shadow:0 0 25px rgba(245,158,11,.9); }
    #message { text-align:center; min-height:48px; font-size:1.1rem; font-weight:600; margin-bottom:10px; }
    .stopwatch { text-align:center; font-size:.9rem; color:#9ca3af; }
    button { width:100%; padding:12px; border-radius:999px; border:none; background:#1d4ed8; color:#fff; font-size:1rem; font-weight:600; cursor:pointer; margin-top:10px; }
    button.secondary { background:#374151; }
    button:disabled { opacity:.5; cursor:not-allowed; }
    .overlay { position:fixed; inset:0; background:rgba(2,6,23,.92); display:none; align-items:center; justify-content:center; z-index:10; }
    .overlay .card { background:#020617; border-radius:14px; padding:20px; width:320px; box-shadow:0 20px 40px rgba(0,0,0,.6); text-align:center; }
    .overlay .q { font-size:1.05rem; margin-bottom:14px; }
    .overlay .btns { display:flex; gap:10px; }
  </style>
</head>
<body>
<div class="panel">
  <h1>Red Light Green Light</h1>

  <div class="lights">
    <div id="red" class="light red"></div>
    <div id="amber" class="light amber"></div>
    <div id="green" class="light green"></div>
  </div>

  <div id="message"></div>
  <div class="stopwatch" id="stopwatch">00:00</div>

  <button id="startBtn">Start</button>
  <button id="readyBtn" class="secondary" disabled>Ready Mode</button>
  <button id="resetBtn" class="secondary">Reset</button>
</div>

<div id="overlay" class="overlay">
  <div class="card">
    <div id="question" class="q"></div>
    <div class="btns">
      <button id="yesBtn">Yes</button>
      <button id="noBtn" class="secondary">No</button>
    </div>
  </div>
</div>

<script>
/* ================= AUDIO ================= */
let audioCtx;

function initAudio(){
  if(!audioCtx){
    audioCtx = new (window.AudioContext||window.webkitAudioContext)();
  }
}

function tone(freq, duration=0.25, gain=0.25){
  initAudio();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.connect(g).connect(audioCtx.destination);
  o.type = 'sine';
  o.frequency.value = freq;
  g.gain.value = gain;
  o.start();
  o.stop(audioCtx.currentTime + duration);
}

function beep(type){
  if(type==='green') tone(750);
  if(type==='red') tone(300);
  if(type==='amber') tone(520,0.35);
  if(type==='question'){
    tone(900,0.15);
    setTimeout(()=>tone(600,0.2),180);
  }
}

/* ============== GAME DATA (UNCHANGED) ============== */
const authorityRed = ['Stop right there','Maintain control','Follow the rules','Discipline required','Hands off your cock'];
const encouragingRed = ['Pause here','Take a breath','Not yet','Easy now','Wait'];
const greenTexts = ['Jerk jerk jerk','Keep pumping','Keep moving','Fuck youself','Pump that cock','Jerk it','Violate yourself'];
const punishments = ['Show your desperation','Flap your cock around','Hump the air','Present for inspection','Hips in the air'];

const judgementQuestions = [
  { q:'Have you followed the rules?', yesPunish:0.2, noPunish:0.8 },
  { q:'Have you been perving?', yesPunish:0.7, noPunish:0.3 },
  { q:'Do you like a finger in the arse?', yesPunish:0.6, noPunish:0.4 },
  { q:'Do you like to expose youself?', yesPunish:0.7, noPunish:0.3 },
  { q:'Do you like being watched?', yesPunish:0.6, noPunish:0.4 }
];

/* ============== CORE LOGIC ============== */
let phase=null, timer=null, stopwatchTimer=null, secondsElapsed=0, rtcActive=false;

function clearLights(){
  ['red','green','amber'].forEach(id=>document.getElementById(id).classList.remove('active'));
}

function setPhase(p){
  phase=p;
  clearLights();
  document.getElementById(p).classList.add('active');
  beep(p);
  if(p==='red') message.textContent = authorityRed[Math.floor(Math.random()*authorityRed.length)];
  if(p==='green') message.textContent = greenTexts[Math.floor(Math.random()*greenTexts.length)];
  if(p==='amber') message.textContent = punishments[Math.floor(Math.random()*punishments.length)];
}

function startStopwatch(){
  stopwatchTimer=setInterval(()=>{
    secondsElapsed++;
    stopwatch.textContent =
      String(Math.floor(secondsElapsed/60)).padStart(2,'0')+':' +
      String(secondsElapsed%60).padStart(2,'0');
  },1000);
}

/* ============== READY MODE ============== */
function readyMode(){
  if(rtcActive) return;
  rtcActive=true;
  clearInterval(timer);

  let red=5, green=15;
  setPhase('red');

  function cycle(){
    if(phase==='red'){
      setPhase('green');
      setTimeout(cycle, green*1000);
    } else {
      setPhase('red');
      setTimeout(cycle, red*1000);
    }
  }

  setTimeout(cycle, red*1000);

  setTimeout(()=>{
    clearLights();
    message.textContent='Verdict incoming...';
    setTimeout(()=>{
      if(Math.random()<0.5){
        message.textContent='Cum now';
        document.getElementById('green').classList.add('active');
        beep('green');
      } else {
        message.textContent='Denied';
        beep('amber');
        rtcActive=false;
        readyMode();
      }
    },2500);
  },60000);
}

/* ============== EVENTS ============== */
startBtn.onclick=()=>{
  initAudio();
  if(timer) return;
  setPhase('red');
  timer=setInterval(()=>setPhase(phase==='red'?'green':'red'),12000);
  startStopwatch();
  readyBtn.disabled=false;
};

readyBtn.onclick=readyMode;

resetBtn.onclick=()=>{
  clearInterval(timer);
  clearInterval(stopwatchTimer);
  timer=null;
  stopwatchTimer=null;
  rtcActive=false;
  secondsElapsed=0;
  clearLights();
  message.textContent='';
  stopwatch.textContent='00:00';
  readyBtn.disabled=true;
};
</script>
</body>
</html>
